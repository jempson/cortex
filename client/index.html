<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
    <title>CORTEX - Secure Wave Communications</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0ead69">
    <meta name="description" content="Privacy-first federated communication platform inspired by Google Wave">

    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cortex">
    <link rel="apple-touch-icon" href="/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">

    <style>
      /* ============ CSS THEME VARIABLES ============ */
      :root {
        /* Backgrounds */
        --bg-base: #050805;
        --bg-elevated: #0a100a;
        --bg-surface: #0d150d;
        --bg-hover: #1a2a1a;
        --bg-active: #243424;

        /* Text - Enhanced brightness for mobile readability */
        --text-primary: #d5e5d5;
        --text-secondary: #a5b5a5;
        --text-dim: #7a8a7a;
        --text-muted: #5a6a5a;

        /* Borders - Increased visibility */
        --border-primary: #3a4a3a;
        --border-secondary: #4a5a4a;
        --border-subtle: #2a3a2a;

        /* Accent Colors */
        --accent-amber: #ffd23f;
        --accent-teal: #3bceac;
        --accent-green: #0ead69;
        --accent-orange: #ff6b35;
        --accent-purple: #a855f7;

        /* Status Colors */
        --status-success: #0ead69;
        --status-warning: #ffd23f;
        --status-error: #ff6b35;
        --status-info: #3bceac;

        /* Glow/Shadow Colors */
        --glow-amber: rgba(255, 210, 63, 0.6);
        --glow-teal: rgba(59, 206, 172, 0.6);
        --glow-green: rgba(14, 173, 105, 0.6);
        --glow-orange: rgba(255, 107, 53, 0.6);
        --glow-purple: rgba(168, 85, 247, 0.6);

        /* Transparent Overlays */
        --overlay-amber: rgba(255, 210, 63, 0.15);
        --overlay-teal: rgba(59, 206, 172, 0.15);
        --overlay-green: rgba(14, 173, 105, 0.15);
        --overlay-orange: rgba(255, 107, 53, 0.15);
        --overlay-purple: rgba(168, 85, 247, 0.15);
      }

      /* High Contrast Dark Theme */
      [data-theme="highContrast"] {
        --bg-base: #000000;
        --bg-elevated: #0a0a0a;
        --bg-surface: #141414;
        --bg-hover: #1e1e1e;
        --bg-active: #282828;
        --text-primary: #ffffff;
        --text-secondary: #d0d0d0;
        --text-dim: #a0a0a0;
        --text-muted: #707070;
        --border-primary: #505050;
        --border-secondary: #606060;
        --border-subtle: #303030;
      }

      /* AMOLED Black Theme */
      [data-theme="amoled"] {
        --bg-base: #000000;
        --bg-elevated: #000000;
        --bg-surface: #0a0a0a;
        --bg-hover: #141414;
        --bg-active: #1e1e1e;
        --text-primary: #ffffff;
        --text-secondary: #c0c0c0;
        --text-dim: #909090;
        --text-muted: #606060;
        --border-primary: #2a2a2a;
        --border-secondary: #3a3a3a;
        --border-subtle: #1a1a1a;
      }

      /* Light Mode Theme */
      [data-theme="light"] {
        --bg-base: #f0f2f0;
        --bg-elevated: #ffffff;
        --bg-surface: #e8eae8;
        --bg-hover: #d8dad8;
        --bg-active: #c8cac8;
        --text-primary: #1a1a1a;
        --text-secondary: #3a3a3a;
        --text-dim: #5a5a5a;
        --text-muted: #7a7a7a;
        --border-primary: #c0c0c0;
        --border-secondary: #d0d0d0;
        --border-subtle: #e0e0e0;
        --accent-amber: #c9a000;
        --accent-green: #0a8a52;
        --status-success: #0a8a52;
        --status-warning: #c9a000;
        --glow-amber: rgba(201, 160, 0, 0.4);
        --glow-green: rgba(10, 138, 82, 0.4);
        --overlay-amber: rgba(201, 160, 0, 0.12);
        --overlay-green: rgba(10, 138, 82, 0.12);
      }

      /* Ocean Blue Theme */
      [data-theme="ocean"] {
        --bg-base: #0a1420;
        --bg-elevated: #0f1a28;
        --bg-surface: #142230;
        --bg-hover: #1a2a3a;
        --bg-active: #203444;
        --text-primary: #e0eef8;
        --text-secondary: #a0c0d8;
        --text-dim: #6090b0;
        --text-muted: #406080;
        --border-primary: #2a4050;
        --border-secondary: #3a5060;
        --border-subtle: #1a3040;
        --accent-amber: #ffc107;
        --accent-teal: #00bcd4;
        --accent-green: #4caf50;
        --accent-orange: #ff7043;
        --accent-purple: #7c4dff;
        --status-success: #4caf50;
        --status-info: #00bcd4;
        --glow-amber: rgba(255, 193, 7, 0.6);
        --glow-teal: rgba(0, 188, 212, 0.6);
        --glow-green: rgba(76, 175, 80, 0.6);
      }

      /* ============ BASE STYLES ============ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body {
        font-family: 'Courier New', Monaco, 'Lucida Console', monospace;
        background: var(--bg-base);
        color: var(--text-primary);
        text-rendering: optimizeLegibility;
        -webkit-tap-highlight-color: var(--overlay-amber);
      }

      /* Custom scrollbar styling */
      * {
        scrollbar-width: thin;
        scrollbar-color: var(--border-primary) var(--bg-elevated);
      }

      *::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      *::-webkit-scrollbar-track {
        background: var(--bg-elevated);
      }

      *::-webkit-scrollbar-thumb {
        background: var(--border-primary);
        border-radius: 4px;
      }

      *::-webkit-scrollbar-thumb:hover {
        background: var(--border-secondary);
      }

      /* Make scrollbars always visible on mobile */
      @media (max-width: 600px) {
        *::-webkit-scrollbar {
          width: 6px;
          height: 6px;
        }
      }
    </style>
  </head>
  <body>
    <script>
      // Apply theme immediately before React loads to prevent flash
      (function() {
        try {
          // First try dedicated theme storage (fastest)
          var theme = localStorage.getItem('cortex_theme');
          // Fallback to user object in storage
          if (!theme) {
            var user = localStorage.getItem('cortex_user');
            if (user) {
              var parsed = JSON.parse(user);
              theme = parsed?.preferences?.theme;
            }
          }
          if (theme && ['firefly', 'highContrast', 'amoled', 'light', 'ocean'].includes(theme)) {
            document.documentElement.setAttribute('data-theme', theme);
          }
        } catch (e) {
          // Silently fail - React will apply theme later
        }
      })();
    </script>
    <div id="root"></div>
    <script type="module" src="/main.jsx"></script>
  </body>
</html>
